{
  "builders": [
    {
      "type": "docker",
      "image": "cluster/golang:0.1",
      "changes": ["EXPOSE 80", "CMD /sbin/my_init"],
      "pull": "false",
      "commit": true
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": [
	"mkdir /frontend && mkdir -p /etc/service/frontend"
      ]
    },
    {
      "type": "file",
      "source": "../lib/trivial_service/www/www.go",
      "destination": "/frontend/www.go"
    },
    {
      "type": "file",
      "source": "service_definitions/frontend.sh",
      "destination": "/etc/service/frontend/run"
    },
    {
      "type": "shell",
      "inline": [
	". /etc/profile && cd /frontend && go build www.go && chmod +x /etc/service/frontend/run"
      ]
    }
  ],
  "post-processors": [
    {
      "type": "docker-tag",
      "repository": "cluster/frontend",
      "tag": "0.1"
    }
  ]
}
